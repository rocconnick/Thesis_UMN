%!TEX root = ../thesis_phd.tex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% simulation.tex: Chapter on MC production:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Monte Carlo Simulation}
\label{sim_chapter}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


The \nova simulation chain involves many components to deliver an accurate representation; starting with protons on the \numi target and running all the way through APD readout in the \nova detectors.  FLUKA and FLUGG are used to simulate the flux in the NuMI beamline.  \cite{fluka}  Neutrino interactions are simulated using \genie. \cite{genie}  \geant is used to propagate products of the neutrino interactions through a detailed model of the \nova~detectors. \cite{geant}  Custom NOvA simulation software converts energy depositions into electronic signals.


\section{Beam Simulation}


Stuff here.  \textit{Gotta figure out what.}

\section{\genie -- Neutrino Interaction Simulation}

\genie is a comprehensive neutrino MC generator for the experimental physics community.  According the \genie collaboration mission statement, the generator aims to simulate processes  for all neutrino species and all nuclear targets, from the MeV to PeV scale.  The input to GENIE is the simulated detector flux from FLUKA/FLUGG; the output is a collection of neutrino interactions described as \genie event records.  \genie event records catalog the the flavor and kinematics of the incoming neutrino, struck nucleus, and daughter particles which leave the nucleus.

Nuclear structure is at the core of neutrino interaction simulation, for which \genie uses  Relativistic Fermi Gas model of Bodek and Ritchie.  \cite{bodekritchie}  At low energies, this gives a reasonable approximation of nuclear binding energies and struck nucleon momentum.  At higher energies, it provides a model for shadowing and other effects.

A principal component in neutrino event generation is interaction cross sections.  In order to generate events across such a wide range of energies, \genie must stitch together a variety of cross section models.  \genie calculates a total cross section by integrating over the differential cross sections from the various models.  The total cross section is combined with the flux (from FLUKA and FLUGG simulations in this case) and detector geometry to produce the overall energy spectrum of interacting neutrinos.  Since this step is relatively computationally expensive, \genie computes the energy spectra separately and stores the interpolated result as interpolates splines.  For each generated event, the energy splines are sampled to select the interaction energy, but the differential cross sections are used to sample the remaining kinematics.


While \genie employs several cross section models, only few are important for this work.  The selected \numu CC events in \nova are dominated by just three interaction modes: Quasi-Eleastic scattering (QE),  baryon resonance production (RES) and deep inelastic scattering (DIS).  QE events dominate the low energy tail of the energy spectrum, while DIS events account for most of the high energy tail.  The QE model in \genie is an implementation of the Llewellyn-Smith model \cite{LlewellynSmith} with a dipole form factor.  In that implementation, the axial vector mass is the sole free parameter.  RES events are generated using from the Rein-Segal model \cite{rein1981neutrino}, which employs the Feynman-Kislinger-Ravndal (FKR) model of baryon resonances \cite{feynman1971current}.  FKR parameterizes resonance wavefuctions as excited states of a 3-quark system in a relativistic harmonic oscillator potential.  The \genie implementation of Rein-Segal neglects interference between resonances as well as outgoing lepton masses.  Similar to the QE model, this RES implementation leaves the axial vector mass.  For DIS interactions, \genie uses a leading order model with corrections from Bodek and Yang \cite{bodek2003higher} to better describe the low $Q^2$ region.  This crossover energy region where DIS interactions begin to dominate is of principal importance to \nova since it accounts for most of the events on the high side of the energy peak.  \genie calculates DIS cross sections at the parton level, or in other words, the cross section involves all sea and valence quarks.  This implementation of DIS involves many free parameters, although most of them have small effects on the \numu CC event selection in \nova.

Free parameters in \genie will be discussed further in chapter \ref{systs_chapter}.  For now, it is important to note that \genie includes a reweighting feature or all free parameters in the models it includes.  For any given event, a weight can be determined by calculating the cross section with a modification of one of the free parameters.  The weights are calculated simply by taking the ratio of this modified cross section to the original cross section.


\section{\geant -- Daughter Propagation}

\geant is a popular software suite for simulating the passage of particles through matter.  In the \nova simulation chain, \genie produces daughter particles leaving the nucleus, then \geant simulates the passage of those particles through matter.  \geant is thus responsible for the energy deposition, interaction and decay of those particles within the detector and surrounding materials.

This propagation relies on a detailed representation of the detector geometry which the describes position of assorted materials.  The locations of the planes have been taken from the as-built locations measured by a laser scan system, although it does not include the precisely measured tilt and stager on a plane-by-plane basis.  Certain features are impossible to measure and incorporate into the geometry, for instance the location of the fiber within the cells and glue voids between modules.  The geometry also includes materials surrounding the detector.  These materials include the steel support structure around the detectors, the rock and concrete comprising the detector halls, as well as the overburden above the FD.

The models which govern interaction, energy deposition and decay of particles in GEANT is highly configurable through so-called \textit{physics lists}.  \nova simulation uses the QGSP\_BERT\_HP physics list by default; although other physics lists have been used to study systematic effects, namely FTF\_BIC, QGSP\_BIC\_HP and QGSC\_BERT.  QGS refers to the quark-gluon string model for hadronic interactionsÂ above 20 GeV. \cite{kaidalov1982pomeron}  QGSC uses the Chiral Invariant Phase Space (CHIPS) model for nuclear de-excitation. \cite{kossov2002chiral}  QGSP, on the other hand, uses the G4Precompound model for nuclear de-excitation.  BERT implies that the Bertini cascade model is used for hadronic interactions below 10 GeV. \cite{bertini1971news,guthrie1968calculation}  The low energy parametrized (LEP) model is used for intermediate energies in all cases.  BIC refers to the Binary cascade model, which can be used for interactions below 10 GeV in place of BERT. \cite{folger2004binary}  FTF is uses the FRITOF description of string excitation and fragmentation to model interactions in the high energy regime instead of the quark-gluon string model. \cite{andersson1993fritiof}  HP represents the \geant high precision neutron simulation.

Daughter particles are propagated through detector.  \geant handles propagation of particles, decays, hadronic interactions, electromagnetic interactions, knock ons, etc.

\section{Photon Transport}

Photons are transported from the point of energy deposition to the  readout.  Ray tracing.  Attenuation.


\section{Electronic Readout}

Count photons in cell.  Convert to ADC.  Do sag.  Add this noise, that noise, some other noise.  Run DCS alg.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
